<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ORION SQUID GAMES 2.0 | REAL-TIME</title>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-database.js"></script>

    <style>
        :root {
            --pink: #ff2e63; --green: #00ff41; --gold: #ffd700;
            --dark: #050505; --red: #ff0000; --vip: #1a0033;
        }

        body {
            background-color: var(--dark); color: white;
            font-family: 'Courier New', monospace; margin: 0;
            display: flex; flex-direction: column; align-items: center;
            padding: 20px; min-height: 100vh; overflow-x: hidden;
        }

        /* DISE√ëO DE INTERFAZ */
        .card {
            background: rgba(255,255,255,0.05); border: 1px solid #333;
            border-radius: 10px; padding: 20px; width: 100%;
            max-width: 600px; margin-bottom: 20px; position: relative;
        }

        .logo { font-size: 2.5rem; letter-spacing: 10px; text-shadow: 0 0 15px var(--pink); text-align: center; }
        
        button {
            width: 100%; padding: 15px; margin: 5px 0;
            background: var(--pink); border: none; color: white;
            font-weight: bold; cursor: pointer; border-radius: 5px;
        }

        button:disabled { background: #222; color: #555; }

        /* ESTADOS */
        .status-alive { color: var(--green); border: 1px solid var(--green); padding: 5px; }
        .status-dead { color: var(--red); border: 1px solid var(--red); padding: 5px; filter: grayscale(1); }

        /* CONTENEDOR DE JUEGOS */
        #game-viewport {
            min-height: 200px; border: 2px dashed #444;
            display: flex; flex-direction: column; align-items: center; justify-content: center;
            margin: 20px 0; padding: 10px;
        }

        .vip-mode { background: linear-gradient(to bottom, #050505, var(--vip)); border-color: var(--gold); }
    </style>
</head>
<body>

    <header>
        <p class="logo">üî∫‚ö™üü¶</p>
        <h1>ORION <span style="color:var(--pink)">SYSTEM</span></h1>
    </header>

    <div id="auth-screen" class="card">
        <h3>IDENTIFICACI√ìN REQUERIDA</h3>
        <input type="text" id="username" placeholder="NOMBRE DEL ALUMNO" style="width:95%; padding:10px; margin-bottom:10px;">
        <button onclick="joinGame()">ENTRAR A LA ARENA</button>
    </div>

    <div id="main-arena" class="card" style="display:none;">
        <div style="display:flex; justify-content:space-between; align-items:center;">
            <h2 id="p-number">#000</h2>
            <span id="p-status" class="status-alive">VIVO</span>
        </div>
        
        <div id="game-viewport">
            <h3 id="game-title">SALA DE ESPERA</h3>
            <p id="game-instruction">Esperando al Guardi√°n...</p>
            <div id="game-content"></div>
        </div>

        <div id="spell-practice">
            <small style="color:var(--pink)">DUELOS R√ÅPIDOS</small>
            <div style="display:grid; grid-template-columns: 1fr 1fr; gap:5px;">
                <button onclick="cast('Expelliarmus')" style="font-size:10px; background:none; border:1px solid var(--pink)">Expelliarmus</button>
                <button onclick="cast('Crucio')" style="font-size:10px; background:none; border:1px solid var(--pink)">Crucio</button>
            </div>
        </div>
    </div>

    <script>
        // CONFIGURACI√ìN DE FIREBASE
        const firebaseConfig = {
            databaseURL: "https://squid-games-24283-default-rtdb.firebaseio.com/"
        };
        firebase.initializeApp(firebaseConfig);
        const db = firebase.database();

        let myId = null;

        // UNIRSE AL JUEGO
        function joinGame() {
            const name = document.getElementById('username').value;
            if(!name) return alert("Pon tu nombre");
            
            myId = "user_" + Math.floor(Math.random() * 10000);
            const playerNum = Math.floor(Math.random() * 456 + 1).toString().padStart(3, '0');
            
            db.ref('players/' + myId).set({
                name: name,
                number: playerNum,
                status: "ALIVE"
            });

            document.getElementById('auth-screen').style.display = 'none';
            document.getElementById('main-arena').style.display = 'block';
            document.getElementById('p-number').innerText = "#" + playerNum;
            
            listenToGame();
        }

        // ESCUCHAR CAMBIOS DEL GUARDI√ÅN
        function listenToGame() {
            // Escuchar estado del jugador (por si lo matas)
            db.ref('players/' + myId).on('value', snap => {
                const data = snap.val();
                if(data.status === "DEAD") {
                    setVipMode();
                }
            });

            // Escuchar qu√© juego activa el Guardi√°n
            db.ref('current_game').on('value', snap => {
                const gameType = snap.val();
                loadGame(gameType);
            });
        }

        // MOTOR DE 10 JUEGOS
        function loadGame(type) {
            const container = document.getElementById('game-content');
            const title = document.getElementById('game-title');
            container.innerHTML = "";
            title.innerText = type;

            switch(type) {
                case "Luz Roja":
                    container.innerHTML = "<button onclick='die()'>MOVERSE</button><p>Si pulsas mueres</p>";
                    break;
                case "Puente Cristal":
                    container.innerHTML = "<button onclick='checkStep(1)'>Izquierda</button><button onclick='checkStep(2)'>Derecha</button>";
                    break;
                case "Canicas":
                    container.innerHTML = "<input type='number' id='bet' placeholder='Apuesta'><button onclick='cast()'>Lanzar</button>";
                    break;
                case "Duelo":
                    container.innerHTML = "<p>Usa tus hechizos ahora!</p>";
                    break;
                case "Galleta":
                    container.innerHTML = "<p>Dibuja el patr√≥n sin salirte!</p>";
                    break;
                case "Cuerda":
                    container.innerHTML = "<button onclick='pull()'>TIRAR!!!</button>";
                    break;
                case "Escondite":
                    container.innerHTML = "<p>Busca un refugio en el mapa</p>";
                    break;
                case "Tr√≠v√≠a":
                    container.innerHTML = "<button>A</button><button>B</button>";
                    break;
                case "Sacrificio":
                    container.innerHTML = "<p>Vota a qui√©n eliminar</p>";
                    break;
                case "Final":
                    container.innerHTML = "<h3>DUELO FINAL POR EL ORO</h3>";
                    break;
                default:
                    container.innerHTML = "<p>Esperando inicio...</p>";
            }
        }

        function die() {
            db.ref('players/' + myId).update({status: "DEAD"});
        }

        function setVipMode() {
            document.getElementById('main-arena').classList.add('vip-mode');
            document.getElementById('p-status').innerText = "VIP / MUERTO";
            document.getElementById('p-status').className = "status-dead";
            document.getElementById('game-viewport').innerHTML = "<h3>LOGIA VIP</h3><p>Mira a los vivos morir...</p>";
        }

        function cast(spell) { alert("Lanzaste " + spell); }
    </script>
</body>
</html>
